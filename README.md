# Apache Logs Aggregator

Это приложение является агрегатором данных из access логов веб-сервера Apache с сохранением в базу данных SQLite.

## Функциональность

- Просмотр данных, сохранённых в базе данных (группировка по IP, по дате, выборка по промежутку дат).
- API для получения данных в виде JSON (получение данных по временному промежутку, возможность группировать/фильтровать по IP).
- Конфигурация через файл настроек (где лежат логи, маска файлов и другие настройки).

## Установка

1. **Клонирование репозитория**

    ```sh
    git clone https://github.com/ileztom/Apache-Logs-Aggregator.git
    cd Apache-Logs-Aggregator
    ```

2. **Создание конфигурационного файла**

    Создайте файл `config.txt` в корневом каталоге проекта со следующим содержимым:

    ```txt
    LogDirectory=./logs
    LogFilePattern=*.log
    MinuteOfUpdate=5
    ShowCron=true
    ```

3. **Создание директории для логов**

    В корневом каталоге проекта создайте директорию `logs` и добавьте туда файлы логов для тестирования.

4. **Добавление файла логов**

    Внутри директории `logs` создайте файл с именем `access.log` и добавьте в него пример логов Apache, например:

    ```plaintext
    127.0.0.1 - - [12/Jun/2023:06:25:45 +0000] "GET / HTTP/1.1" 200 612 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"
    127.0.0.1 - - [12/Jun/2023:06:26:15 +0000] "GET /favicon.ico HTTP/1.1" 404 209 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"
    ```


## Использование

После запуска приложения в консоли будут доступны следующие команды:

- `open` - открывает в редакторе по умолчанию файл конфига.
- `parse` - полученные данные из логов записывает в базу данных, получает данные из конфига, сопоставляет их с логими.
- `getlog (date|datefrom dateto ip status)` - получает данные логов из уже выгруженной базе данных.
- `clear` - очищает консоль и выводит список доступных команд.
- `close` - завершение программы.

**Примеры использования команд:**

- `open` - Открывает конфигурационный файл.
- `parse` - Парсит файлы логов и сохраняет данные в базу данных.
- `getlog 12-06-2023` - Получает все логи за 12 июня 2023 года.
- `getlog 12-06-2023 13-06-2023 127.0.0.1 200` - Получает логи за период с 12 июня 2023 года по 13 июня 2023 года для IP-адреса 127.0.0.1 и статусом 200.


## Формат данных

Дата в запросе указывается в формате "dd-mm-yyyy", "dd.mm.yyyy", "dd-/mm/yyyy" или "dd-/mmm/yyyy":

- 12.06.2024
- 12-06-2024
- 12/Jun/2024

IP-адрес указывается в стандартном формате "ddd.ddd.ddd.ddd":

- 127.0.0.1
- 192.168.1.1


## Обработка ошибок

- Программа выводит сообщения об ошибках в консоль в удобочитаемом виде.
- В случае отсутствия конфигурационного файла `config.txt` или директории `logs` программа уведомит об этом и завершит работу.


## Выход из приложения

Для выхода из приложения используйте `close`.
